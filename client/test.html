<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="stylesheet" href="./css/stylesheet.css">
    <link rel="stylesheet" href="./css/backend.css">
    <link rel="stylesheet" href="./css/calendar.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/59ecaaffaa.js" crossorigin="anonymous"></script>

</head>

<body>
    <div class="flex flex-row">
        <h1 class="pl-1">user id:</h1>
        <h1 class="pl-2">Taux Horaire:</h1>
        <h1 class="pl-8">DATE:</h1>
        <h1 class="pl-8">Temps de travail:</h1>
        <h1 class="pl-4">Gain total:</h1>
    </div>
    <div class="flex flex-row">
        <div class="flex flex-col id-container pl-8 ">
        </div>
        <div class="flex flex-col rate-container pl-10">
        </div>
        <div class="flex flex-col date-container pl-10">
        </div>
        <div class="flex flex-col time-container pl-10">
        </div>
        <div class="flex flex-col gain-container pl-10">
        </div>
    </div>
</body>
<script>
    var url = "http://cdapp.test:88/api";

    window.addEventListener("DOMContentLoaded", (event) => {
        getdata()
    });

    function getdata() {

        fetch(url)
            .then((res) => res.json())
            .then((out) => {

                console.table(out);

                const text = JSON.stringify(out);
                const obj = JSON.parse(text);

                console.table(obj);

                let textFromJSON = obj;
                textFromJSON.forEach(appendNewThing)

                function appendNewThing(jsonTxt) {
                    //user_ID
                    let container = document.createElement("div");
                    container.className = "child-holder";
                    let newP = document.createElement("p");
                    newP.className = "child";
                    let newContent = document.createTextNode(jsonTxt.user_id);
                    newP.appendChild(newContent);
                    container.appendChild(newP);
                    document.getElementsByClassName("id-container")[0].appendChild(container);

                    //Taux Horaire
                    let container2 = document.createElement("div");
                    container2.className = "child-holder2";
                    let newP2 = document.createElement("p");
                    newP2.className = "child2";
                    let newContent2 = document.createTextNode(jsonTxt.h_rate + " €");
                    newP2.appendChild(newContent2);
                    container2.appendChild(newP2);
                    document.getElementsByClassName("rate-container")[0].appendChild(container2);

                    //date
                    let container3 = document.createElement("div");
                    container3.className = "child-holder3";
                    let newP3 = document.createElement("p");
                    newP3.className = "child3";
                    datefr = jsonTxt.date.split('-').reverse().join('-')
                    let newContent3 = document.createTextNode(datefr);
                    newP3.appendChild(newContent3);
                    container3.appendChild(newP3);
                    document.getElementsByClassName("date-container")[0].appendChild(container3);
                    // Temps de travail
                    let container4 = document.createElement("div");
                    container4.className = "child-holder4";
                    let newP4 = document.createElement("p");
                    newP4.className = "child4";
                    let newContent4 = document.createTextNode(jsonTxt.work_time + " h");
                    newP4.appendChild(newContent4);
                    container4.appendChild(newP4);
                    document.getElementsByClassName("time-container")[0].appendChild(container4);
                    //gain total
                    let container5 = document.createElement("div");
                    container5.className = "child-holder5";
                    let newP5 = document.createElement("p");
                    newP5.className = "child5";
                    var a = jsonTxt.work_time.split(':'); // split it at the colons
                    var minutes = (+a[0]) * 60 + (+a[1]);
                    let newContent5 = document.createTextNode(jsonTxt.h_rate / 60 * minutes + " €");
                    newP5.appendChild(newContent5);
                    container5.appendChild(newP5);
                    document.getElementsByClassName("gain-container")[0].appendChild(container5);

                }
            });

    }
</script>

</html>